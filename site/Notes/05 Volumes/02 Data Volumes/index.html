<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Shams Nahid">
        <link rel="canonical" href="http://docker-study.shams-nahid.com/Notes/05 Volumes/02 Data Volumes/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>02 Data Volumes - Docker Study Notes</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../../../css/extra.css" rel="stylesheet">

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">Docker Study Notes</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../..">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Notes <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">01 Docker Essential</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../01 Docker Essential/01 Docker 101/">01 Docker 101</a>
</li>
            
<li >
    <a href="../../01 Docker Essential/02 Docker Container/">02 Docker Container</a>
</li>
            
<li >
    <a href="../../01 Docker Essential/03 Docker Lifecycle/">03 Docker Lifecycle</a>
</li>
            
<li >
    <a href="../../01 Docker Essential/04 Docker Basic Commands/">04 Docker Basic Commands</a>
</li>
            
<li >
    <a href="../../01 Docker Essential/05 Create Custom Image/">05 Create Custom Image</a>
</li>
            
<li >
    <a href="../../01 Docker Essential/06 Wrap Web App in Docker/">06 Wrap Web App in Docker</a>
</li>
            
<li >
    <a href="../../01 Docker Essential/07 Using Docker Compose/">07 Using Docker Compose</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">02 CI CD With Docker</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../02 CI-CD With Docker/01 Single Container CI-CD Workflow/">01 Single Container CI CD Workflow</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">02  multi container</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../02 CI-CD With Docker/02  multi-container/01 Multi-container development environment/">01 Multi container development environment</a>
</li>
            
<li >
    <a href="../../02 CI-CD With Docker/02  multi-container/02 Multi-container Continuous Integration/">02 Multi container Continuous Integration</a>
</li>
            
<li >
    <a href="../../02 CI-CD With Docker/02  multi-container/03 Multi-container Continuous Deployment/">03 Multi container Continuous Deployment</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">03 Running container Like A Boss</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../03 Running container Like A Boss/01 Intro/">Using Container Like A Boss</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/02 Play With Nginx Server/">Play With Nginx Server</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/03 With Container Run/">With Container Run</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/04 Container vs VM/">Container vs VM</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/05 Windows Containers/">Windows Containers</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/06 Assignment of Multiple Containers/">06 Assignment of Multiple Containers</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/07 CLI Process Monitoring/">07 CLI Process Monitoring</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/08 Getting a Shell Inside a Container/">08 Getting a Shell Inside a Container</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/09 IP Fact/">09 IP Fact</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/10 Container Networking/">10 Container Networking</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/11 Assignments/">11 Assignments</a>
</li>
            
<li >
    <a href="../../03 Running container Like A Boss/12 Assignment/">12 Assignment</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">04 Images</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../04 Images/01 Caching/">01 Caching</a>
</li>
            
<li >
    <a href="../../04 Images/02 Tagging/">02 Tagging</a>
</li>
            
<li >
    <a href="../../04 Images/03 Building Image/">03 Building Image</a>
</li>
            
<li >
    <a href="../../04 Images/04 Assignment/">04 Assignment</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">05 Volumes</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../01 Data Persistent/">01 Data Persistent</a>
</li>
            
<li class="active">
    <a href="./">02 Data Volumes</a>
</li>
            
<li >
    <a href="../03 Bind Mounting/">03 Bind Mounting</a>
</li>
            
<li >
    <a href="../04 Assignment: Named Volumes/">04 Assignment: Named Volumes</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">06 Docker Compose</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../06 Docker Compose/01 Overview/">01 Overview</a>
</li>
            
<li >
    <a href="../../06 Docker Compose/02 Example/">02 Example</a>
</li>
            
<li >
    <a href="../../06 Docker Compose/03 Assignment 01/">03 Assignment 01</a>
</li>
            
<li >
    <a href="../../06 Docker Compose/04 Building Image/">04 Building Image</a>
</li>
            
<li >
    <a href="../../06 Docker Compose/05 Assignment 02/">05 Assignment 02</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">07 swarm</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../07 swarm/01 Overview/">01 Overview</a>
</li>
            
<li >
    <a href="../../07 swarm/02 Swarm Service/">02 Swarm Service</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">08 Docker on AWS</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">01 ECS Quick Start</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../08 Docker on AWS/01 ECS Quick Start/01 ECS vs Fargate/">01 ECS vs Fargate</a>
</li>
            
<li >
    <a href="../../08 Docker on AWS/01 ECS Quick Start/02 IAM User/">02 IAM User</a>
</li>
            
<li >
    <a href="../../08 Docker on AWS/01 ECS Quick Start/03 First Container Launch/">03 First Container Launch</a>
</li>
            
<li >
    <a href="../../08 Docker on AWS/01 ECS Quick Start/04 ECS Pricing/">04 ECS Pricing</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">02 ECS Cluster Setup</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../08 Docker on AWS/02 ECS Cluster Setup/01 Overview/">01 Overview</a>
</li>
            
<li >
    <a href="../../08 Docker on AWS/02 ECS Cluster Setup/02 IAM Roles For ECS/">02 IAM Roles For ECS</a>
</li>
            
<li >
    <a href="../../08 Docker on AWS/02 ECS Cluster Setup/03 Core Infrastructure for ECS/">03 Core Infrastructure for ECS</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../01 Data Persistent/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../03 Bind Mounting/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/bmshamsnahid/My-Docker-Study"><i class="fa fa-github"></i> GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#data-volumes">Data Volumes</a></li>
        <li class="main "><a href="#named-volumes-an-enhance-of-data-volumes">Named Volumes (An Enhance of Data Volumes)</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="data-volumes">Data Volumes</h3>
<hr />
<p>If we use <code>Data Volumes</code> to persist data, we have to define a volume. Then any files or data put in that volume will outlive the container. If we remove the container, it will not remove the data volume, instead we have to take one more step to remove the volume, <code>docker volume prune</code>. This extra step is just for an insurance, to ensure the the data volumes are much more important than the container itself.</p>
<p>Let's pull the <code>mysql</code> image,</p>
<pre><code class="docker">docker pull mysql
</code></pre>

<p>Now, inspect the image,</p>
<pre><code class="docker">docker image inspect mysql
</code></pre>

<p>Inside the <code>Config.Volumes</code>, we should see a volumes, <code>/var/lib/mysql</code>.</p>
<p>We now run a container from the image,</p>
<pre><code class="docker">docker container run -d --name mysql -e MYSQL_ALLOW_EMPTY_PASSWORD=true mysql
</code></pre>

<p>We can verify the container is running by,</p>
<pre><code class="docker">docker container ls
</code></pre>

<p>In the output list, we should see the <code>mysql</code> container is running.</p>
<p>We can inspect the container,</p>
<pre><code class="docker">docker container inspect mysql
</code></pre>

<p>Under <code>Mounts</code>, we should see <code>/var/lib/mysql</code> as mounted volumes list. When a container is running, the container assume the directory path is <code>/var/lib/mysql</code>, but it's actual path is defined in the <code>Source</code> property and in my case, the actual path is <code>/var/lib/docker/volumes/0097b12ff7e460e44174a208e8c52ba40eeb882723696e8057906403c3a17e13/_data</code>.</p>
<p>We can see the list of mounted volumes,</p>
<pre><code class="docker">docker volume ls
</code></pre>

<p>This should give all the mounted volumes by the docker containers.</p>
<p>We can get the volume name by the <code>docker container inspect mysql</code>. From this command output, under <code>Mounts</code>, we can get the mounted volumes name. To inspect our specific volume, we can run inspect command by the name,</p>
<pre><code class="docker">docker volume inspect 0097b12ff7e460e44174a208e8c52ba40eeb882723696e8057906403c3a17e13
</code></pre>

<p>In output, there is a property <code>Mountpoint</code> and from the linux machine, we can directly access that mount point,</p>
<pre><code class="bash">cd /var/lib/docker/volumes/0097b12ff7e460e44174a208e8c52ba40eeb882723696e8057906403c3a17e13/_data
</code></pre>

<p>This should take us the <code>_data</code> directory.</p>
<p>Lets, remove the mysql container,</p>
<pre><code class="docker">docker container rm mysql
</code></pre>

<p>Now, if we look for the volumes,</p>
<pre><code class="docker">docker volume ls
</code></pre>

<p>We will notice, even though our container is removed, our data is persisted. This solves our data persistency problem.</p>
<p>Although, from container, we can find the mounted volumes, but from volume perspective, we can not say which container it is connected to.</p>
<h3 id="named-volumes-an-enhance-of-data-volumes">Named Volumes (An Enhance of Data Volumes)</h3>
<hr />
<p>To make <code>Data Volumes</code> more user friendly, we can use <code>Named Volumes</code>. To use <code>Named Volumes</code> we have to specify the volume config on the <code>docker run</code> command with <code>-v</code> flag.</p>
<p>We can create a mysql container with <code>Named Volume</code> by,</p>
<pre><code class="docker">docker container run -d --name mysql -e MYSQL_ALLOW_EMPTY_PASSWORD=true -v mysql-db:/var/lib/mysql mysql
</code></pre>

<p>Now we can easily inspect the volume by name,</p>
<pre><code class="docker">docker volume inspect mysql-db
</code></pre>

<p>This will give the details of the <code>mysql-db</code> platform.</p>
<p>It is also possible to create volume ahead of time.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2021 <a href="https://shams-nahid.com/">Shams Nahid</a>.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
